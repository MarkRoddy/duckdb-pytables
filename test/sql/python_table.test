# name: test/sql/python_table.test
# description: test python_udf extension
# group: [python_udf]

# Before we load the extension, this will fail
statement error
SELECT columnA FROM python_table('udfs', 'table', ['columnA']);
----
Catalog Error: Table Function with name python_table does not exist!

# Require statement will ensure this test is run with this extension loaded
require python_udf


# Check that an invalid module is handled
statement error
select python_table('udfsss', 'table', ['Jane'], ['columnA']) as result;
Error: Invalid Error: No such module: udfsss


# Correctly handle when a function does not exist
statement error
select python_table('udfs', 'tablesssss', ['Jane'], ['columnA'])) as result;
Error: Invalid Error: No such function: tablesssss


# Confirm the extension works
query I
SELECT * FROM python_table('udfs', 'table', ['Jane'], ['columnA'])
----
a
 
v
e
r
y
 
l
o
n
g
 
s
t
r
i
n
g


# Confirm usage with multiple arguments
query I
SELECT * FROM python_table('udfs', 'table2', ['foo', 'bar', 16], ['columnA'])
----
f
o
o
b
a
r
16

